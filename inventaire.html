<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inventaire Code 39</title>
<style>
  body { font-family: sans-serif; padding: 20px; }
  input { font-size: 1.5em; padding: 10px; width: 100%; margin-bottom: 20px; }
  ul { list-style: none; padding: 0; }
  li { padding: 5px 0; border-bottom: 1px solid #ccc; font-size: 1.2em; }
  button { padding: 10px 20px; font-size: 1em; margin-top: 10px; }
</style>
</head>
<body>
<h1>Inventaire Code 39</h1>
<input id="scan" placeholder="Scannez un code-barres" autofocus />
<ul id="liste"></ul>
<button id="export">Exporter en CSV</button>

<script>
const inventaire = [];
const scanInput = document.getElementById('scan');
const liste = document.getElementById('liste');
const exportBtn = document.getElementById('export');

scanInput.addEventListener('keypress', function(e) {
    if (e.key === "Enter") {
        let code = this.value.replace(/\*/g, "").trim(); // retirer les * du Code 39
        if(code && !inventaire.includes(code)) {
            inventaire.push(code);
            let li = document.createElement('li');
            li.textContent = code;
            liste.appendChild(li);
        }
        this.value = "";
    }
});

exportBtn.addEventListener('click', () => {
    if(inventaire.length === 0) return alert("Aucun code Ã  exporter");
    const csv = inventaire.join("\n");
    const blob = new Blob([csv], {type: "text/csv"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = "inventaire.csv";
    a.click();
    URL.revokeObjectURL(url);
});
</script>
</body>
</html>